=== Training Experiment Model 2026 ===
Loading dataset from C:\Users\t4kic\Documents\JapanHorseRacePrediction\scripts\training\../../data/processed/dataset_2010_2025.pkl...
DEBUG: df_proc columns: Index(['着順', '枠番', '馬番', '馬名', '性齢', '斤量', '騎手', 'タイム', '着差', 'タイム指数'], dtype='object')
DEBUG: df_proc index name: None
DEBUG: df_proc index names: [None]
Loading DeepFM scores from C:\Users\t4kic\Documents\JapanHorseRacePrediction\scripts\training\../../data/processed/deepfm_scores.csv...
Merged DeepFM scores. Added feature 'deepfm_score'.
Total samples: 773068
Features: 59
Splitting data...
Selected features: 31
Train: 680291 (2010-2023)
Val:   45280 (2024)
Training LightGBM...
Training until validation scores don't improve for 50 rounds
[100]	train's auc: 0.844993	valid's auc: 0.855365
[200]	train's auc: 0.849204	valid's auc: 0.858607
[300]	train's auc: 0.851574	valid's auc: 0.859621
[400]	train's auc: 0.85354	valid's auc: 0.860082
[500]	train's auc: 0.855404	valid's auc: 0.860412
Did not meet early stopping. Best iteration is:
[485]	train's auc: 0.855137	valid's auc: 0.860413
Metrics: {'accuracy': 0.8325530035335689, 'precision': 0.683271375464684, 'recall': 0.45735045287150394, 'f1': 0.5479370379203434, 'auc': 0.8604134913817525}
モデル(lgbm)を保存しました: C:\Users\t4kic\Documents\JapanHorseRacePrediction\models\experiment_model_2026.pkl
Model saved to C:\Users\t4kic\Documents\JapanHorseRacePrediction\models\experiment_model_2026.pkl
Done.
