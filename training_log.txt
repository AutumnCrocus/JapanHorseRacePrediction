=== Model Training (2010-2020) Started ===
Loading data...
Filtering data from 2010-01-01 to 2020-12-31...
Train samples: 543383
Processing features...
Debug: Processing results...
Debug: Adding horse history...
Debug: Adding course suitability...
Debug: Adding jockey features...
Debug: Adding pedigree features...
Debug: Adding odds features...
Constructing clean training set...
Valid features: 31
Debug: df_clean columns: ['枠番', '馬番', '斤量', 'jockey_id', 'course_len', 'race_type', 'venue_id', 'kai', 'day', 'race_num', '性', '年齢', '体重', '体重変化', 'running_style', 'avg_rank', 'win_rate', 'place_rate', 'race_count', 'avg_last_3f', 'avg_running_style', 'interval', 'prev_rank', 'same_distance_win_rate', 'same_type_win_rate', 'jockey_avg_rank', 'jockey_win_rate', 'jockey_return_avg', 'peds_score_speed', 'peds_score_stamina', 'peds_score_dirt', 'target', 'date']
Debug: df_clean shape: (538702, 33)
Debug: date type: <class 'pandas.core.series.Series'>
Dropped 0 rows with missing target/date
Sorting...
Splitting...
Train size: 430961, Val size: 107741
Training...
Training until validation scores don't improve for 50 rounds
[100]	train's auc: 0.779251	valid's auc: 0.778234
[200]	train's auc: 0.787832	valid's auc: 0.782412
[300]	train's auc: 0.793093	valid's auc: 0.783745
[400]	train's auc: 0.797478	valid's auc: 0.784844
[500]	train's auc: 0.801508	valid's auc: 0.785222
Did not meet early stopping. Best iteration is:
[476]	train's auc: 0.8007	valid's auc: 0.78531
Saving model to C:\Users\t4kic\Documents\JapanHorseRacePrediction\models\historical_2010_2020...
モデル(lgbm)を保存しました: C:\Users\t4kic\Documents\JapanHorseRacePrediction\models\historical_2010_2020\model.pkl
Training Completed Successfully.
